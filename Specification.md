# fließend - 仕様書

**Version:** 0.1.0 (Draft)
**Last Updated:** 2025-11-01

---

## 概要

フォルダ構造をアウトライナーのように編集できるツール。
思考を流れるように整理すると、そのままファイルシステムが整理される。

**キーワード:** アウトライナー、ファイルシステム、双方向同期、思考の流動性

---

## 1. 背景と動機

### 1.1 問題意識

- **エディターの限界**: テキストは自由に編集できるが、フォルダ構造には触れられない
- **ファイラーの限界**: フォルダ構造は見えるが、テキストみたいに自由に編集できない
- **この二つの世界の境界を超えたい**

### 1.2 なぜ作るのか

満足したこと（釣りの記録、写真、メモ）を「こねくり回せる状態」で残したい。
思考を固定せず、流動的に扱いたい。

与太話を膨らませて、いじくり回して、また新しい形にする。そのための遊び場。

### 1.3 理論的背景

**AIとフォルダ構造の親和性**

AIシステムがファイルを直接扱える時代において、階層的なフォルダ構造はネットワーク型よりも重要性を増す：

- フォルダ階層はAIにとって「コンテキスト境界」を提供する
- セマンティック検索だけでは不十分 → 階層で絞ってから検索する方が効率的
- Dustの事例: AIエージェントが自発的に「ファイルシステム風のナビゲーション」を発明した
- コンテキストウィンドウの制約: 階層構造があると必要な部分だけ読み込める

**参考:** `In the era of AI systems capable of directly handl.md`

---

## 2. コアコンセプト

### 2.1 核心的なアイディア

```
アウトライナーを編集していたら、
そのままフォルダ構造が整理されている
```

- **左側のペイン（ファイルツリー）をテキストのように編集する**
- インデント変えたらフォルダが移動する
- コピペでフォルダ構造を複製する
- Claudeと対話しながら構造を整理する

### 2.2 基本思想

#### フォルダとファイルの等価性
「フォルダ」と「ファイル」を区別せず、"ノード"として扱う。
見た目も操作感も同一。

#### 思考＝構造
ユーザーは思考を整理しているつもりで、実際にはファイルシステムが整理されている。
「アウトラインを編むこと」が「情報構造を再構築すること」。

#### 操作の即時性
ノード名変更・階層変更・ファイル作成/削除が、すべてワンアクションで完結する。

---

## 3. 機能要件

### 3.1 MVP（Minimum Viable Product）

#### 必須機能

| 機能 | 説明 | 優先度 |
|------|------|--------|
| ノード追加 | 新規フォルダ/ファイル作成 | P0 |
| ノード移動 | Tab/Shift+Tabでインデント変更 | P0 |
| ノード削除 | ファイル/フォルダ削除 | P0 |
| ノード名変更 | アウトライン上でリネーム | P0 |
| 双方向同期 | ファイルシステムと即座に同期 | P0 |
| Markdown展開 | Markdownファイルの内容を展開表示 | P1 |

#### 操作イメージ

```
プロジェクト/
  ├─ ドキュメント/
  │   ├─ 企画書.md
  │   └─ 仕様書.md
  ├─ コード/
  │   └─ main.py
  └─ 写真/
      ├─ IMG_001.jpg  # 夕陽が綺麗だった
      └─ IMG_002.jpg
```

- `Tab`: 選択ノードを一段階下げる（親フォルダに移動）
- `Shift+Tab`: 選択ノードを一段階上げる
- `Enter`: ノード名編集モード
- `Cmd+N`: 新規ノード作成
- `Delete`: ノード削除

### 3.2 拡張機能（将来）

- メタデータ（.outline-meta/）: フォルダに「ノート欄」を持たせる
- 重複名許容: 内部でUUID管理、表示名と実際のフォルダ名を分離
- ターミナル統合: Ctrl+Tでターミナルを開く
- 画像プレビュー: 画像ファイルのサムネイル表示
- AI統合: Claudeと対話しながらフォルダを整理

---

## 4. 技術仕様

### 4.1 技術スタック（案）

**開発環境:** macOS

**選択肢:**

#### Option 1: Electron + Node.js
- **メリット**:
  - 開発速度が速い（MVP: 1-2ヶ月）
  - クロスプラットフォーム対応
  - Web技術で実装可能
- **デメリット**:
  - アプリサイズが大きい（100MB+）
  - パフォーマンス面で劣る可能性
- **推奨**: MVPフェーズ

#### Option 2: Tauri + Rust
- **メリット**:
  - 軽量（アプリサイズ10MB程度）
  - 高速
  - セキュリティ
- **デメリット**:
  - Rust学習コスト
  - 開発速度がElectronより遅い

#### Option 3: Swift + SwiftUI (Native)
- **メリット**:
  - ネイティブパフォーマンス
  - macOSとの深い統合
- **デメリット**:
  - macOS専用
  - 開発時間が長い（3-6ヶ月）

**推奨戦略:**
1. ElectronでMVP開発・検証
2. ユーザーフィードバックを得る
3. 必要に応じてTauri/Nativeへ移行

### 4.2 アーキテクチャ（Electron版）

```
┌─────────────────────────────────┐
│    Renderer Process (UI)        │
│  - React / Vue / Svelte         │
│  - Outline Tree Component       │
│  - File System Viewer           │
└─────────────┬───────────────────┘
              │ IPC
┌─────────────▼───────────────────┐
│    Main Process (Node.js)       │
│  - File System API (fs)         │
│  - File Watcher (chokidar)      │
│  - CRUD Operations              │
└─────────────┬───────────────────┘
              │
┌─────────────▼───────────────────┐
│    Local File System            │
│  - Folders & Files              │
│  - .outline-meta/ (metadata)    │
└─────────────────────────────────┘
```

### 4.3 双方向同期の実装

**ファイル監視:**
- `chokidar` (Node.js) でファイルシステムを監視
- 変更をリアルタイムでUIに反映

**衝突解決:**
- 最終更新日時で判定
- ユーザーに選択させる（上書き/キャンセル）

### 4.4 メタデータ構造

```json
// .outline-meta/node-uuid.json
{
  "id": "abc123",
  "displayName": "プロジェクト資料（長いタイトル...）",
  "realPath": "プロジェクト資料",
  "note": "このフォルダには企画書と仕様書が入っている。",
  "tags": ["#企画", "#2025"],
  "created": "2025-11-01T10:00:00Z",
  "updated": "2025-11-01T15:30:00Z"
}
```

---

## 5. UXデザイン

### 5.1 画面構成

```
┌─────────────────────────────────────────┐
│  fließend                         [- □ ×]│
├─────────────────────────────────────────┤
│  File  Edit  View  Help                 │
├─────────────────────────────────────────┤
│                                          │
│  📁 Projects/                            │
│    📁 fließend/                          │
│      📄 README.md                        │
│      📄 Specification.md                 │
│    📁 旅行計画/                          │
│      📄 日程.md                          │
│      📷 IMG_001.jpg  # 夕陽が綺麗だった  │
│                                          │
│  [+ New Node]                            │
│                                          │
└─────────────────────────────────────────┘
```

### 5.1.1 アイコンとインジケーター（MVP仕様）

**基本表示:**
- すべてのノード（フォルダ・ファイル）にバレット `・` を表示
- インデントで階層を視覚化

**ホバー時の挙動:**
- フォルダにマウスホバー時のみ、バレットの左に展開状態インジケーターを表示
  - `>` : 閉じている（子要素が隠れている）
  - `∨` : 開いている（子要素が見えている）
- ファイルにホバーしてもバレットのまま（変化なし）

**表示例:**

通常時:
```
  ・Documents/
    ・Projects/
      ・README.md
      ・Specification.md
    ・Photos/
```

ホバー時（開いているフォルダ）:
```
 ∨・Documents/         ← マウスカーソル
    ・Projects/
      ・README.md
```

ホバー時（閉じているフォルダ）:
```
  ・Documents/
    ・Projects/
 >・Photos/            ← マウスカーソル
```

**デザイン意図:**
- ミニマルで視覚的ノイズを減らす
- 必要なときだけ操作要素を表示
- アウトライナーライクな統一感

### 5.2 キーボードショートカット

| キー | 動作 |
|------|------|
| `Tab` | ノードを一段階下げる |
| `Shift+Tab` | ノードを一段階上げる |
| `Enter` | ノード名編集 |
| `Cmd+N` | 新規ノード |
| `Delete` | ノード削除 |
| `Cmd+D` | ノード複製 |
| `Cmd+X/C/V` | カット/コピー/ペースト |
| `Space` | ノード展開/折りたたみ |
| `Cmd+F` | 検索 |

---

## 6. 開発ロードマップ

### Phase 0: プロトタイプ (2週間)
- [ ] 基本UIの作成
- [ ] ファイル一覧表示
- [ ] ノード追加・削除
- [ ] 簡易な階層変更

### Phase 1: MVP (1-2ヶ月)
- [ ] 双方向同期の実装
- [ ] ノード移動（Tab/Shift+Tab）
- [ ] ファイルシステム操作
- [ ] Markdown展開機能
- [ ] 基本的なエラーハンドリング

### Phase 2: β版 (3-4ヶ月)
- [ ] メタデータ機能
- [ ] UI/UXの洗練
- [ ] パフォーマンス最適化
- [ ] ユーザーテスト

### Phase 3: v1.0 (6ヶ月)
- [ ] 安定版リリース
- [ ] ドキュメント整備
- [ ] コミュニティ形成

---

## 7. 類似プロジェクト

### 最も近いコンセプト

**OutWiker**
- ノートツリーをディスク上のディレクトリ構造として保存
- ツリー構造でノート管理
- 相違点: 純粋なアウトライナーUIではない

**Leo Editor**
- アウトライナー形式でファイル/コードを管理
- 外部ファイルとの「ライブ同期」機能
- 相違点: 独自の.leoファイルに構造を保存

### fließendの独自性

以下の要素を**すべて組み合わせた**プロジェクトは存在しない：

1. 純粋なアウトライナーインターフェース
2. ファイルとフォルダの完全な等価性
3. Tab/Shift+Tabによるインデント操作で階層を変更
4. 即座のファイルシステム反映（リアルタイム双方向同期）
5. Markdownファイルの展開・編集

---

## 8. 参考資料

### プロジェクト内ドキュメント
- `アプリコンセプト.md` - 初期コンセプトと基本思想
- `アウトライナーでフォルダ整理アプリ - Grok.md` - 技術的詳細の対話
- `類似コンセプトのプロジェクト調査結果.md` - 競合調査
- `In the era of AI systems capable of directly handl.md` - 理論的背景
- `Electronの開発環境セットアップ...md` - 技術選定

### 外部リンク
- [Electron Documentation](https://www.electronjs.org/)
- [Tauri](https://tauri.app/)
- [chokidar (File Watcher)](https://github.com/paulmillr/chokidar)
- [OutWiker](https://jenyay.net/Outwiker/English)
- [Leo Editor](https://leoeditor.com/)

---

## 9. 用語集

- **ノード**: フォルダまたはファイルを表すアウトラインの1行
- **インデント**: ノードの階層レベル（Tab/Shift+Tabで変更）
- **双方向同期**: UIの変更→ファイルシステム、ファイルシステムの変更→UI
- **メタデータ**: フォルダに付随する追加情報（ノート、タグなど）
- **MVP**: Minimum Viable Product（実用最小限の製品）

---

## 10. 開発哲学

> "書くことが、整理することになる。"
> "ファイルシステムの文体化。"
> "フォルダと文章を同じ文法で扱う。"

思考を流れるように。固定せず、こねくり回せる状態で。

---

**Status:** Draft
**Next Steps:** プロトタイプ開発の開始
